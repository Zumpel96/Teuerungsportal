@page "/stores/{storeName}"

<PageTitle>@L?["appName"] - @L?["store"]</PageTitle>

<MudGrid>
    <MudItem xs="12">
        @if (IsLoadingMeta)
        {
            <MudSkeleton Width="20%" Height="2rem"/>
        }
        else
        {
            <MudBreadcrumbs Items="@Breadcrumbs"/>
        }
    </MudItem>

    <MudItem xs="12">
        @if (IsLoadingMeta)
        {
            <MudSkeleton Width="40%" Height="8rem"/>
        }
        else
        {
            <MudText Typo="Typo.h1">@CurrentStore.Name</MudText>
        }
        <MudAlert Severity="Severity.Info">@L?["storeInfo"]</MudAlert>
        <MudDivider/>
    </MudItem>

    <MudItem xs="12">
        <MudTabs Rounded="true" ApplyEffectsToContainer="true">
            <MudTabPanel Text="@L?["recentPriceChanges"]">
                <MudPaper>
                    @if (IsLoadingMeta)
                    {
                        <MudSkeleton Width="100%" Height="20rem"/>
                    }
                    else
                    {
                        <RecentPriceChanges PriceChanges="@PaginatedPriceHistory" Page="@CurrentPricePage" NumberOfPages="PricePages" PageChanged="@OnPricePageChanged" HideStore IsLoading="@IsLoadingPriceData"/>
                    }
                </MudPaper>
            </MudTabPanel>

            <MudTabPanel Text="@L?["chart"]">
                <MudPaper>
                    <MudAlert Severity="Severity.Info">@L?["chartInfo"]</MudAlert>
                    @if (IsLoadingPriceData)
                    {
                        <MudSkeleton SkeletonType="SkeletonType.Rectangle" Width="100%" Height="400px"/>
                    }
                    else
                    {
                        <InflationChart ChartData="@TotalPriceHistory"/>
                    }
                </MudPaper>
            </MudTabPanel>
            
            <MudTabPanel Text="@L?["products"]">
                <MudPaper>
                    @if (IsLoadingMeta)
                    {
                        <MudSkeleton Width="100%" Height="20rem"/>
                    }
                    else
                    {
                        <ProductTable Products="@Products" Page="@CurrentProductPage" NumberOfPages="ProductPages" PageChanged="@OnProductPageChanged" HideStore IsLoading="@IsLoadingProductData"/>
                    }
                </MudPaper>
            </MudTabPanel>
        </MudTabs>
    </MudItem>
</MudGrid>
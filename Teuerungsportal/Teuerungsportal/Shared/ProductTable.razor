@using Teuerungsportal.Models
<MudTable Items="@Products" Hover="true" Loading="@IsLoading">
    <HeaderContent>
        <MudTh>@L?["productName"]</MudTh>
        <MudTh>@L?["articleNumber"]</MudTh>
        <MudTh>@L?["brand"]</MudTh>
        @if (!HideCategory)
        {
            <MudTh>@L?["category"]</MudTh>
        }
        @if (!HideStore)
        {
            <MudTh>@L?["store"]</MudTh>
        }
        <MudTh></MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="@L?["productName"]">@context.Name</MudTd>
        <MudTd DataLabel="@L?["articleNumber"]">@context.ArticleNumber</MudTd>
        <MudTd DataLabel="@L?["brand"]">@context.Brand</MudTd>
        @if (!HideCategory)
        {
            <MudTd Class="responsive-table-text" DataLabel="@L?["category"]">
                @if (context.Category == null)
                {
                    <MudSelect Disabled="@(IsCategorizing || IsLoading)" T="Category?" Placeholder="@L?["addCategory"]" AnchorOrigin="Origin.BottomCenter" Variant="Variant.Outlined" AdornmentIcon="@Icons.Material.Filled.Search" AdornmentColor="Color.Primary" ValueChanged="@((Category? category) => AddCategory(context, category))">
                        @foreach (var category in AllCategories)
                        {
                            <CategoryVisualizer Category="@category" RecursionLevel="0"/>

                            @if (category != AllCategories.Last())
                            {
                                <MudSelectItem Value="@(new Category())" Disabled>
                                    <MudDivider/>
                                </MudSelectItem>
                            }
                        }
                    </MudSelect>
                }
                else
                {
                    @context.Category?.Name
                }
            </MudTd>
        }
        @if (!HideStore)
        {
            <MudTd DataLabel="@L?["store"]">@context.Store?.Name</MudTd>
        }
        <MudTd>
            <MudIconButton Icon="@Icons.Material.Filled.ArrowForwardIos" OnClick="@(() => Redirect(context))"/>
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudPagination SelectedChanged="@OnPageChanged" BoundaryCount="2" MiddleCount="7" Count="@NumberOfPages" Class="pa-4" Disabled="IsLoading"/>
    </PagerContent>
</MudTable>